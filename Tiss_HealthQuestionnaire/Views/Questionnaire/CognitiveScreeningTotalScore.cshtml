@model Tiss_HealthQuestionnaire.Models.CognitiveScreeningViewModel
@{
    Layout = null;
}
<div class="p-4">
    <h2 class="text-xl font-bold mb-4">認知篩檢分數總合</h2>
    <table class="border-collapse border w-full text-center">
        <thead>
            <tr>
                <th class="border px-4 py-2">項目</th>
                <th class="border px-4 py-2">分數</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td class="border px-4 py-2">定位(Orientation)</td>
                <td class="border px-4 py-2" id="orientationScore">/5</td>
            </tr>
            <tr>
                <td class="border px-4 py-2">短期記憶(ImmediateMemory)</td>
                <td class="border px-4 py-2" id="immediateMemoryScore">/30</td>
            </tr>
            <tr>
                <td class="border px-4 py-2">專注力(Concentration)</td>
                <td class="border px-4 py-2" id="concentrationScore">/4</td>
            </tr>
            <tr>
                <td class="border px-4 py-2">協調與平衡(Coordination)</td>
                <td class="border px-4 py-2" id="coordinationScore">/30</td>
            </tr>
            <tr>
                <td class="border px-4 py-2">延遲記憶(DelayedRecall)</td>
                <td class="border px-4 py-2" id="delayedRecallScore">/10</td>
            </tr>
            <tr class="font-bold bg-gray-100">
                <td class="border px-4 py-2">總分</td>
                <td class="border px-4 py-2" id="finalScore">/79</td>
            </tr>
        </tbody>
    </table>
</div>

<script>
    function initializeSummary() {
        const orientation = parseInt(sessionStorage.getItem('OrientationScore')) || 0;
        const immediate = parseInt(sessionStorage.getItem('ImmediateMemoryScore')) || 0;
        const concentration = parseInt(sessionStorage.getItem('ConcentrationScore')) || 0;
        const coordinationErrors = parseInt(sessionStorage.getItem('CoordinationErrorScore')) || 0;
        const coordinationScore = (30 - coordinationErrors) < 0 ? 0 : (30 - coordinationErrors);
        const delayedRecall = parseInt(sessionStorage.getItem('DelayedRecallTotalScore')) || 0;

        $('#orientationScore').text(`${orientation} / 5`);
        $('#immediateMemoryScore').text(`${immediate} / 30`);
        $('#concentrationScore').text(`${concentration} / 4`);
        $('#coordinationScore').text(`${coordinationScore} / 30`);
        $('#delayedRecallScore').text(`${delayedRecall} / 10`);

        const final = orientation + immediate + concentration + coordinationScore + delayedRecall;
        $('#finalScore').text(`${final} / 79`);

        sessionStorage.setItem('TotalScore', final);
    }
</script>